import Classifier from 'ml-classify-text';
import {activeDataSet} from "./parser.middle.active.ts";

export const classifier = new Classifier();


const cancel = [
    '‚ÄºÔ∏è–£–≤–∞–∂–∞–µ–º—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏! –í 18:00 –∑–∞–Ω—è—Ç–∏–µ –ø–æ –ü—Å–∏—Ö–æ–ª–æ–≥–∏–∏ —Å –Æ–ª–∏–µ–π –ù–∞—É–º–æ–≤–æ–π –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç—Å—è. –ø—Ä–∏–Ω–æ—Å–∏–º —Å–≤–æ–∏ –∏–∑–≤–∏–Ω–µ–Ω–∏—è.‚ÄºÔ∏è',
    '‚ÄºÔ∏è–£–≤–∞–∂–∞–µ–º—ã —É—á–∞—Å—Ç–Ω–∏–∫–∏ –Ω–∞ 11:05  —á–∞—Å–æ–≤ –∑–∞–Ω—è—Ç–∏–µ –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç—Å—è‚ÄºÔ∏è',
    '‚ÄºÔ∏è–£–≤–∞–∂–∞–µ–º—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏! –ó–∞–Ω—è—Ç–∏–µ –ø–æ –ö–∏–Ω–µ–∑–∏–æ—Ç–µ—Ä–∞–ø–∏–∏ –≤ 12:30 –Ω–µ —Å–æ—Å—Ç–æ–∏—Ç—Å—è ! ‚ÄºÔ∏è'
];
const update = [`‚ùóÔ∏è–°–ï–ì–û–î–ù–Ø ‚ùóÔ∏è

18:00-20:00
ü™∑–ú–ê–ö - –∏—Å—Å–ª–µ–¥–æ–≤–∞–Ω–∏–µ
"–Ø –ò –ú–û–ô –í–ù–£–¢–†–ï–ù–ù–ò–ô –ö–û–ú–ü–ê–°" —Å –ø–æ–º–æ—â—å—é –º–µ—Ç–∞—Ñ–æ—Ä–∏—á–µ—Å–∫–∏—Ö –∞—Å—Å–æ—Ü–∏–∞—Ç–∏–≤–Ω—ã—Ö –∫–∞—Ä—Ç
–í–µ–¥–µ—Ç –ò–Ω–Ω–∞( –∑–∞–ª –ò–≥—Ä–æ—Ç–µ–∫–∏)
üí•—Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏—è –æ—Ç–∫—Ä—ã—Ç–∞ - 2 —á–µ–ª–æ–≤–µ–∫–∞`];


const other = [
    `–£–≤–∞–∂–∞–µ–º—ã–µ —É—á–∞—Å—Ç–Ω–∏–∫–∏!!! –í–Ω–∏–º–∞—Ç–µ–ª—å–Ω–æ —Å–º–æ—Ç—Ä–∏—Ç–µ —Å–ø–∏—Å–æ–∫ —Ä–µ–≥–∏—Å—Ç—Ä–∞—Ü–∏–∏. –ù–∞ 18:30 —É–∂–µ 13 —á–µ–ª–æ–≤–µ–∫.`,
    `–£ –º–µ–Ω—è –≤—Å–µ –ø—Ä–∞–≤–∏–ª—å–Ω–æ, –≤–ø–µ—Ä–µ–¥–∏ –º–µ–Ω—è —Ç–æ–ª—å–∫–æ –Ω–æ–º–µ—Ä 2,—Ç–∞–∫ —á—Ç–æ —è 3.`,
    `–ò—Ä–∞ 10 —É–∂–µ –µ—Å—Ç—å –≤—ã—à–µ`
];

classifier.train(cancel, 'cancel');
classifier.train(update, 'update');
classifier.train(activeDataSet, 'active');
classifier.train(other, 'other');

type MessageTextTypes = "active" | "other" | "cancel" | "update" | "none";

export function classifyMessageText(text: string): MessageTextTypes {
    const p = classifier.predict(text)
    if (p.length) {
        return p[0]?.label || "none"
    }
    return "none"
}