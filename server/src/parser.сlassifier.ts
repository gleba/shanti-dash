import Classifier from 'ml-classify-text';
import {activeDataSet} from "./parser.middle.active.ts";

export const classifier = new Classifier();

const trainTypes = {
    scheduleCancel: [
        'â€¼ï¸Ð£Ð²Ð°Ð¶Ð°ÐµÐ¼Ñ‹Ðµ ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¸! Ð’ 18:00 Ð·Ð°Ð½ÑÑ‚Ð¸Ðµ Ð¿Ð¾ ÐŸÑÐ¸Ñ…Ð¾Ð»Ð¾Ð³Ð¸Ð¸ Ñ Ð®Ð»Ð¸ÐµÐ¹ ÐÐ°ÑƒÐ¼Ð¾Ð²Ð¾Ð¹ Ð½Ðµ ÑÐ¾ÑÑ‚Ð¾Ð¸Ñ‚ÑÑ. Ð¿Ñ€Ð¸Ð½Ð¾ÑÐ¸Ð¼ ÑÐ²Ð¾Ð¸ Ð¸Ð·Ð²Ð¸Ð½ÐµÐ½Ð¸Ñ.â€¼ï¸',
        'â€¼ï¸Ð£Ð²Ð°Ð¶Ð°ÐµÐ¼Ñ‹ ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¸ Ð½Ð° 11:05  Ñ‡Ð°ÑÐ¾Ð² Ð·Ð°Ð½ÑÑ‚Ð¸Ðµ Ð½Ðµ ÑÐ¾ÑÑ‚Ð¾Ð¸Ñ‚ÑÑâ€¼ï¸',
        'â€¼ï¸Ð£Ð²Ð°Ð¶Ð°ÐµÐ¼Ñ‹Ðµ ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¸! Ð—Ð°Ð½ÑÑ‚Ð¸Ðµ Ð¿Ð¾ ÐšÐ¸Ð½ÐµÐ·Ð¸Ð¾Ñ‚ÐµÑ€Ð°Ð¿Ð¸Ð¸ Ð² 12:30 Ð½Ðµ ÑÐ¾ÑÑ‚Ð¾Ð¸Ñ‚ÑÑ ! â€¼ï¸'
    ],
    scheduleUpdate: [`â—ï¸Ð¡Ð•Ð“ÐžÐ”ÐÐ¯ â—ï¸

18:00-20:00
ðŸª·ÐœÐÐš - Ð¸ÑÑÐ»ÐµÐ´Ð¾Ð²Ð°Ð½Ð¸Ðµ
"Ð¯ Ð˜ ÐœÐžÐ™ Ð’ÐÐ£Ð¢Ð Ð•ÐÐÐ˜Ð™ ÐšÐžÐœÐŸÐÐ¡" Ñ Ð¿Ð¾Ð¼Ð¾Ñ‰ÑŒÑŽ Ð¼ÐµÑ‚Ð°Ñ„Ð¾Ñ€Ð¸Ñ‡ÐµÑÐºÐ¸Ñ… Ð°ÑÑÐ¾Ñ†Ð¸Ð°Ñ‚Ð¸Ð²Ð½Ñ‹Ñ… ÐºÐ°Ñ€Ñ‚
Ð’ÐµÐ´ÐµÑ‚ Ð˜Ð½Ð½Ð°( Ð·Ð°Ð» Ð˜Ð³Ñ€Ð¾Ñ‚ÐµÐºÐ¸)
ðŸ’¥Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ñ Ð¾Ñ‚ÐºÑ€Ñ‹Ñ‚Ð° - 2 Ñ‡ÐµÐ»Ð¾Ð²ÐµÐºÐ°`],
    other: [
        `Ð£Ð²Ð°Ð¶Ð°ÐµÐ¼Ñ‹Ðµ ÑƒÑ‡Ð°ÑÑ‚Ð½Ð¸ÐºÐ¸!!! Ð’Ð½Ð¸Ð¼Ð°Ñ‚ÐµÐ»ÑŒÐ½Ð¾ ÑÐ¼Ð¾Ñ‚Ñ€Ð¸Ñ‚Ðµ ÑÐ¿Ð¸ÑÐ¾Ðº Ñ€ÐµÐ³Ð¸ÑÑ‚Ñ€Ð°Ñ†Ð¸Ð¸. ÐÐ° 18:30 ÑƒÐ¶Ðµ 13 Ñ‡ÐµÐ»Ð¾Ð²ÐµÐº.`,
        `Ð£ Ð¼ÐµÐ½Ñ Ð²ÑÐµ Ð¿Ñ€Ð°Ð²Ð¸Ð»ÑŒÐ½Ð¾, Ð²Ð¿ÐµÑ€ÐµÐ´Ð¸ Ð¼ÐµÐ½Ñ Ñ‚Ð¾Ð»ÑŒÐºÐ¾ Ð½Ð¾Ð¼ÐµÑ€ 2,Ñ‚Ð°Ðº Ñ‡Ñ‚Ð¾ Ñ 3.`,
        `Ð˜Ñ€Ð° 10 ÑƒÐ¶Ðµ ÐµÑÑ‚ÑŒ Ð²Ñ‹ÑˆÐµ`
    ],
    scheduleNew: activeDataSet,
    registrationNew: [
        `8:30-1`,
        `08-30 1 Ð›ÐµÐ½Ð°`,
        `15.30-1`,
        `19.00-3`,
        `15.30-2`,
        `19.0-4`,
        `15_30_3  ÐÐ`,
        `15_30_3  ÐÐ`,
        `12.30-5
12:30-4`,
        `13:30 6-Ñ€ÐµÐ±ÐµÐ½Ð¾Ðº
13:30 7 -Ñ€Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒ
18.00-7`,
        `Ð›ÑŽÐ´Ð¼Ð¸Ð»Ð°
8:30-10`,
`19:00 - 6 Ð½Ð¾Ð²`,
`8.30-Ð·`,
`Ð›ÑŽÐ´Ð¼Ð¸Ð»Ð°
14.30-6
15.30-9`,
`15.00- 4 Ñ€Ð¾Ð´Ð¸Ñ‚ÐµÐ»ÑŒ
15.00- 5 Ñ€ÐµÐ±ÐµÐ½Ð¾Ðº
15.00- 6 Ñ€ÐµÐ±ÐµÐ½Ð¾Ðº`,
`Ð¢Ð°Ñ‚ÑŒÑÐ½Ð°
15:00-9
17:00-3`,
`08-30 1 Ð›ÐµÐ½Ð°`,
`15.30 - 1 Ð²Ð¾Ð·Ð¼Ð¾Ð¶Ð½Ð¾ Ð¾Ð¿Ð°Ð·Ð´Ð°Ð½Ð¸Ðµ`,
`Ð¢Ð°Ñ‚ÑŒÑÐ½Ð°
8:30-8
11:30-3
14:00-2`
    ],
        registrationCancel: [
`15 30 - 5 Ð¾Ñ‚Ð¼ÐµÐ½Ð°`,
`15:30- 6 Ð¾Ñ‚Ð¼ÐµÐ½Ð°`,
`17 30 - 6 Ð¾Ñ‚Ð¼ÐµÐ½Ð°`,
`17:30-5 Ð¾Ñ‚Ð¼ÐµÐ½Ð°`,
`14:00-7 Ð¾Ñ‚Ð¼ÐµÐ½Ð°`,
`15.30- 3 Ð¾Ñ‚Ð¼ÐµÐ½Ð°`,
`15:30-8 Ð¾Ñ‚Ð¼ÐµÐ½Ð°`,
]
}
Object.keys(trainTypes).forEach(t=>{
    classifier.train(trainTypes[t], t)
})

type MessageTextTypes = keyof typeof trainTypes | "none";

export function classifyMessageText(text?: string): MessageTextTypes {
    if (text) {
        const p = classifier.predict(text)
        // console.log(p)
        if (p.length) {
            return p[0]?.label || "none"
        }
    }
    return "none"
}